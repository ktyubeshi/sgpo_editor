# SGPO Editor 要件定義書

## 1. はじめに

### 1.1 目的

本ドキュメントは、SGPO Editorの開発に関する要件を定義するものです。このドキュメントは以下の目的で使用されます：

- プロジェクトの範囲と目標を明確にする
- ステークホルダー間での共通理解を形成する
- 開発チームが実装すべき機能を特定する
- テストと検証の基準を提供する
- 将来の機能拡張の計画を立てる

### 1.2 対象範囲

本ドキュメントは、SGPO Editorアプリケーションの機能要件、非機能要件、制約条件、およびユースケースについて定義します。ハードウェア要件や開発環境の詳細については、別途システム概要ドキュメントを参照してください。

### 1.3 用語と略語

用語と略語の定義については、[用語集](6_glossary.md)を参照してください。

## 2. プロジェクト概要

### 2.1 背景

ソフトウェアやウェブサイトの国際化（i18n）とローカライゼーション（l10n）のプロセスでは、翻訳リソースの効率的な管理が必要です。gettextのPOファイル形式は広く使用されている標準ですが、既存のPOエディタには使いやすさ、機能性、または現代的なインターフェースの面で不足があります。

### 2.2 プロダクトの目的

SGPO Editorは、翻訳者やローカライゼーションエンジニアが効率的にPOファイルを編集・管理できる、使いやすく機能豊富なツールを提供することを目的としています。このツールは翻訳作業を効率化し、翻訳品質の向上に貢献します。

### 2.3 ステークホルダー

| ステークホルダー | 役割/関心事 |
|-----------------|------------|
| 翻訳者 | POファイルの効率的な編集、翻訳品質の向上 |
| ローカライゼーションエンジニア | 翻訳プロセスの管理、ファイル形式の整合性確保 |
| ソフトウェア開発者 | 国際化対応アプリケーションの翻訳リソース管理 |
| プロジェクトマネージャー | 翻訳進捗の可視化、リソース配分の最適化 |

## 3. 機能要件

### 3.1 コア機能

#### 3.1.1 POファイル操作

| 要件ID | 要件説明 | 優先度 |
|--------|---------|-------|
| REQ-001 | システムはPOファイルを読み込み、内容を表示できること | 必須 |
| REQ-002 | システムはPOファイルの保存と更新ができること | 必須 |
| REQ-003 | システムは編集中のPOファイルの変更状態を追跡し、表示できること | 必須 |
| REQ-004 | システムは複数のPOファイル形式（UTF-8、Latin-1など）に対応すること | 高 |

#### 3.1.2 エントリ表示と編集

| 要件ID | 要件説明 | 優先度 |
|--------|---------|-------|
| REQ-010 | システムはPOファイル内のすべてのエントリをテーブル形式で表示できること | 必須 |
| REQ-011 | システムは選択されたエントリの詳細を表示・編集できるエディタを提供すること | 必須 |
| REQ-012 | システムはエントリの翻訳状態（未翻訳、翻訳済み、要確認）を視覚的に表示できること | 必須 |
| REQ-013 | システムはエントリのコンテキスト情報（msgctxt）とコメントを表示できること | 高 |
| REQ-014 | システムはエントリの編集履歴を保持し、変更を元に戻す機能を提供すること | 中 |

#### 3.1.3 検索とフィルタリング

| 要件ID | 要件説明 | 優先度 |
|--------|---------|-------|
| REQ-020 | システムはキーワードによるエントリの検索機能を提供すること | 必須 |
| REQ-021 | システムは翻訳状態（未翻訳、翻訳済み、要確認）によるフィルタリング機能を提供すること | 必須 |
| REQ-022 | システムは正規表現による高度な検索機能を提供すること | 中 |
| REQ-023 | システムは検索結果間を簡単に移動できるナビゲーション機能を提供すること | 高 |

#### 3.1.4 統計と進捗管理

| 要件ID | 要件説明 | 優先度 |
|--------|---------|-------|
| REQ-030 | システムはPOファイルの翻訳進捗状況（総エントリ数、翻訳済み数、未翻訳数、要確認数）を表示できること | 必須 |
| REQ-031 | システムは翻訳進捗をグラフィカルに表示できること | 中 |
| REQ-032 | システムは特定のフィルタ条件に対する統計情報を動的に計算・表示できること | 低 |

### 3.2 拡張機能

#### 3.2.1 翻訳支援機能

| 要件ID | 要件説明 | 優先度 |
|--------|---------|-------|
| REQ-040 | システムは類似翻訳の提案機能を提供すること | 中 |
| REQ-041 | システムは外部翻訳APIと連携し、機械翻訳の提案を表示できること | 低 |
| REQ-042 | システムは用語集と連携し、一貫した翻訳をサポートできること | 低 |

#### 3.2.2 検証機能

| 要件ID | 要件説明 | 優先度 |
|--------|---------|-------|
| REQ-050 | システムはPOファイルの構文エラーを検出し、報告できること | 高 |
| REQ-051 | システムは翻訳の品質チェック（書式指定子の一致、タグの整合性など）を実行できること | 中 |
| REQ-052 | システムはスペルチェックと文法チェックを提供できること | 低 |

#### 3.2.3 コラボレーション機能

| 要件ID | 要件説明 | 優先度 |
|--------|---------|-------|
| REQ-060 | システムはエントリにコメントやメモを追加できること | 中 |
| REQ-061 | システムはエクスポート機能を提供し、特定の形式（CSV、XLSX）での出力が可能であること | 低 |
| REQ-062 | システムはバージョン管理システムと連携できること | 低 |

### 3.3 カスタマイズと設定

| 要件ID | 要件説明 | 優先度 |
|--------|---------|-------|
| REQ-070 | システムはUIレイアウト（標準、コンパクト、拡張）を切り替えられること | 高 |
| REQ-071 | システムはフォントサイズやカラーテーマなどの表示設定をカスタマイズできること | 中 |
| REQ-072 | システムはショートカットキーをカスタマイズできること | 低 |
| REQ-073 | システムは設定をファイルに保存し、次回起動時に復元できること | 高 |

## 4. 非機能要件

### 4.1 パフォーマンス要件

| 要件ID | 要件説明 | 優先度 |
|--------|---------|-------|
| NFR-001 | システムは10,000エントリ以上のPOファイルを滞りなく処理できること | 必須 |
| NFR-002 | システムはファイル読み込み時にプログレスバーを表示し、1秒以上かかる処理の進捗を示すこと | 高 |
| NFR-003 | システムはUIの応答性を維持し、ユーザー操作に対して500ms以内に反応すること | 高 |
| NFR-004 | システムのメモリ使用量は、通常使用時において512MB以下に抑えること | 中 |

### 4.2 信頼性要件

| 要件ID | 要件説明 | 優先度 |
|--------|---------|-------|
| NFR-010 | システムはファイルの読み込み・保存時にエラーを適切に処理し、データ損失を防止すること | 必須 |
| NFR-011 | システムは編集中のデータに対して自動バックアップ機能を提供すること | 高 |
| NFR-012 | システムはクラッシュ後の再起動時に、直前の状態を回復できること | 中 |

### 4.3 使用性要件

| 要件ID | 要件説明 | 優先度 |
|--------|---------|-------|
| NFR-020 | システムは直感的なUIを提供し、基本操作を30分以内に習得できること | 必須 |
| NFR-021 | システムは主要な操作にキーボードショートカットを提供すること | 高 |
| NFR-022 | システムはすべての操作に対してツールチップまたはヘルプテキストを提供すること | 中 |
| NFR-023 | システムはアクセシビリティ基準に準拠し、スクリーンリーダーなどの支援技術に対応すること | 中 |

### 4.4 互換性要件

| 要件ID | 要件説明 | 優先度 |
|--------|---------|-------|
| NFR-030 | システムはWindows 10/11、macOS 10.15以降、Ubuntu 20.04以降で動作すること | 必須 |
| NFR-031 | システムはPython 3.10以降で動作すること | 必須 |
| NFR-032 | システムはgettext 0.21以降のPOファイル形式に完全に対応すること | 高 |

### 4.5 セキュリティ要件

| 要件ID | 要件説明 | 優先度 |
|--------|---------|-------|
| NFR-040 | システムは外部APIとの通信時に適切な認証と暗号化を使用すること | 高 |
| NFR-041 | システムは一時ファイルやバックアップファイルを安全に管理し、不要になった時点で適切に削除すること | 中 |

### 4.6 国際化要件

| 要件ID | 要件説明 | 優先度 |
|--------|---------|-------|
| NFR-050 | システム自体のUIのベース言語は英語とし、日本語を含む複数言語へのローカライズに対応すること | 高 |
| NFR-051 | システムは右から左へ記述する言語（RTL）のPOファイルを適切に表示・編集できること | 中 |
| NFR-052 | システムはUnicode文字の全範囲を適切に処理できること | 高 |
| NFR-053 | システムはPOファイル自体を使用してUIのローカライズを行うこと | 高 |

## 5. 制約条件

| 制約ID | 制約内容 |
|--------|---------|
| CON-001 | システムはPython 3.10以上の環境で動作すること |
| CON-002 | GUIはPySide6（Qt for Python）を使用して実装すること |
| CON-003 | POファイル操作にはsgpoライブラリを使用すること |
| CON-004 | システムはオープンソースライセンス（MIT）で公開すること |
| CON-005 | 外部依存ライブラリは必要最小限に抑え、依存関係を明確に文書化すること |
| CON-006 | 基本実装言語は英語とし、コードコメントやドキュメント内の識別子も英語で記述すること |

## 6. ユースケース

### 6.1 基本ユースケース

#### UC-001: POファイルを開く

**アクター**: 翻訳者

**前提条件**: アプリケーションが起動していること

**基本フロー**:
1. ユーザーは「ファイルを開く」メニューを選択する
2. システムはファイル選択ダイアログを表示する
3. ユーザーはPOファイルを選択し、「開く」をクリックする
4. システムはファイルを読み込み、エントリテーブルに表示する
5. システムは翻訳統計情報を計算し、表示する

**代替フロー**:
- 3a: ユーザーが「キャンセル」をクリックした場合、処理を中止する
- 4a: ファイル読み込みエラーが発生した場合、エラーメッセージを表示する

**事後条件**: POファイルが読み込まれ、エントリテーブルに表示される

#### UC-002: エントリを編集する

**アクター**: 翻訳者

**前提条件**: POファイルが開かれていること

**基本フロー**:
1. ユーザーはエントリテーブルから編集したいエントリを選択する
2. システムはエントリエディタに選択されたエントリの詳細を表示する
3. ユーザーは訳文を編集する
4. ユーザーは「適用」ボタンをクリックする
5. システムは変更を適用し、エントリテーブルを更新する
6. システムはファイルの変更状態を「変更あり」に設定する

**代替フロー**:
- 4a: ユーザーが他のエントリを選択した場合、変更を適用するか破棄するか確認する
- 4b: ユーザーが「元に戻す」をクリックした場合、編集内容を元の状態に戻す

**事後条件**: エントリが更新され、ファイルの変更状態が「変更あり」になる

#### UC-003: POファイルを保存する

**アクター**: 翻訳者

**前提条件**: POファイルが開かれ、変更されていること

**基本フロー**:
1. ユーザーは「ファイルを保存」メニューを選択する
2. システムは現在開いているファイルに変更を保存する
3. システムはファイルの変更状態を「変更なし」に設定する

**代替フロー**:
- 2a: 保存エラーが発生した場合、エラーメッセージを表示し、ファイルを別名で保存するオプションを提供する

**事後条件**: 変更がファイルに保存され、変更状態が「変更なし」になる

#### UC-004: 検索とフィルタリングを行う

**アクター**: 翻訳者

**前提条件**: POファイルが開かれていること

**基本フロー**:
1. ユーザーは検索テキストボックスにキーワードを入力する
2. ユーザーはフィルタドロップダウンから条件（すべて、未翻訳のみなど）を選択する
3. ユーザーは検索ボタンをクリックする
4. システムは条件に合致するエントリのみをテーブルに表示する
5. システムはフィルタリング結果の統計情報を更新する

**代替フロー**:
- 4a: 検索結果が0件の場合、「一致するエントリが見つかりません」というメッセージを表示する

**事後条件**: 条件に合致するエントリのみがテーブルに表示される

### 6.2 拡張ユースケース

#### UC-010: レイアウトを切り替える

**アクター**: 翻訳者

**前提条件**: アプリケーションが起動していること

**基本フロー**:
1. ユーザーは「表示」メニューから「レイアウト」サブメニューを開く
2. ユーザーは希望するレイアウトタイプ（標準、コンパクト、拡張）を選択する
3. システムはUIレイアウトを選択されたタイプに切り替える

**事後条件**: UIレイアウトが変更される

#### UC-011: POファイルを検証する

**アクター**: 翻訳者

**前提条件**: POファイルが開かれていること

**基本フロー**:
1. ユーザーは「ツール」メニューから「検証」を選択する
2. システムはPOファイルの構文と翻訳品質の検証を実行する
3. システムは検証結果をダイアログに表示する
4. ユーザーは検出された問題を確認し、「閉じる」をクリックする

**代替フロー**:
- 3a: 問題が検出されなかった場合、「問題は見つかりませんでした」というメッセージを表示する

**事後条件**: 検証結果がユーザーに表示される

## 7. 優先順位と開発フェーズ

### 7.1 優先順位の定義

| 優先度 | 説明 |
|--------|------|
| 必須 | 最初のリリースに絶対に含める必要がある機能 |
| 高 | 最初のリリースに含めるべき重要な機能 |
| 中 | 可能であれば最初のリリースに含めたい機能、または次のリリースで追加予定の機能 |
| 低 | 将来のリリースで検討する機能 |

### 7.2 開発フェーズ

#### フェーズ1: 最小機能製品（MVP）
- 基本的なPOファイル操作（読み込み、表示、編集、保存）
- シンプルなUI（エントリテーブルとエディタ）
- 基本的な検索とフィルタリング
- 翻訳統計の表示
- 英語UIの実装

#### フェーズ2: 機能拡張
- UI改善（レイアウト切り替え、設定保存）
- 高度な検索と置換
- POファイル検証
- エラー処理の強化
- 日本語を含む複数言語へのUIローカライズ

#### フェーズ3: 高度な機能
- 翻訳支援機能
- 用語集連携
- 外部APIとの統合
- コラボレーション機能

## 8. 付録

### 8.1 関連ドキュメント

- [システム概要](1_system_overview.md)
- [アーキテクチャ設計](2_architecture_design.md)
- [データモデル設計](3_data_model_design.md)
- [UIコンポーネント設計](4_ui_component_design.md)
- [テスト計画](5_test_plan.md)
- [用語集](6_glossary.md)

### 8.2 承認

| 役割 | 名前 | 日付 |
|------|------|------|
| 要件定義者 |  |  |
| プロジェクトマネージャー |  |  |
| 開発リーダー |  |  |
| QA担当者 |  |  |
